# Default values for worker Helm chart
# This is a YAML-formatted file.

# Worker configuration
worker:
  # Image settings
  image:
    repository: worker
    pullPolicy: IfNotPresent
    tag: "latest"

  # Replica count
  replicaCount: 2

  # Consumer name prefix (will be suffixed with pod name)
  consumerName: "worker"

  # Health endpoint configuration
  healthEndpoint: ":8088"

  # Database configuration
  database:
    host: "postgres"
    port: 5432
    name: "devmesh"
    user: "devmesh"
    password: "changeme"  # Use secret in production
    sslMode: "require"
    searchPath: "mcp,public"

  # AWS configuration (for Bedrock)
  aws:
    region: "us-east-1"
    # Leave empty to use IAM role
    accessKeyId: ""
    secretAccessKey: ""

  # Resource limits
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  # Security context
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000
    readOnlyRootFilesystem: true

  # Pod annotations
  podAnnotations: {}

  # Node selector
  nodeSelector: {}

  # Tolerations
  tolerations: []

  # Affinity rules
  affinity: {}

# Redis configuration (internal)
redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: false
  master:
    persistence:
      enabled: true
      size: 10Gi
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

# External Redis/ElastiCache configuration
# Use this when redis.enabled is false
externalRedis:
  # Redis host (ElastiCache endpoint)
  host: "localhost"
  port: 6379
  password: ""
  # TLS configuration for ElastiCache
  tls:
    enabled: false
    # Skip TLS verification (not recommended for production)
    skipVerify: false

# Service Account
serviceAccount:
  create: true
  name: worker
  annotations: {}
    # For AWS IAM roles: eks.amazonaws.com/role-arn: arn:aws:iam::ACCOUNT:role/ROLE

# Namespace
namespace:
  create: false  # Use same namespace as edge-mcp
  name: edge-mcp